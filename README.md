This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Password reset & email configuration

The app includes a simple forgot-password flow that generates a onetime
link. By default the link is logged in the server console and displayed to the
browser in development; no real mail is sent unless you configure SMTP.

### Setting up SMTP

1. Add the following variables to `.env.local` (or export them in your shell).
   These are **serverside only** so they must _not_ be prefixed with
   `NEXT_PUBLIC_`.

   ```dotenv
   SMTP_HOST=smtp.example.com
   SMTP_PORT=587
   SMTP_SECURE=false   # true for port 465, false for 587
   SMTP_USER=your_user@domain.com   # optional
   SMTP_PASS=your_password          # optional
   SMTP_FROM="Todos App <no-reply@yourdomain.com>"
   NEXT_PUBLIC_APP_URL=http://localhost:3000
   ```

2. Restart both the Next.js (`pnpm run dev`) and Convex (`convex dev`) servers
   so they read the new vars.
3. The Convex backend will now attempt to send mail using [nodemailer]. Errors
   (authentication, connectivity, etc.) appear in the backend terminal.
4. In _development_ the reset link is still returned to the client and logged
   to make testing easier.

> **Security note:** Only the `to` and `from` addresses are under your control;
> the body of the message is generated by the code. Keep `.env.local` out of
> version control and dont commit real credentials.

### Example configuration

```dotenv
SMTP_HOST=smtp.mail.ru
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=your@mail.ru
SMTP_PASS=<app-specific password>
SMTP_FROM="Todos App <no-reply@yourdomain.com>"
```

Depending on the provider you may need to create an app password or allow less
secure access. Messages will often land in spam when sent from `localhost`.

## Dynamic mailing (`auth.sendEmail` mutation)

In addition to the password reset logic, the backend now exposes a generic
mutation that can be used from the frontend to send arbitrary emails:

```ts
// client-side example
import { useMutation } from 'convex/react';
import { api } from '@/convex/_generated/api';

const sendEmail = useMutation(api.auth.sendEmail);

// later...
await sendEmail({
  to: 'recipient@example.com',
  subject: 'Hello!',
  text: 'This is a dynamic message sent from the app.',
  html: '<p>This is a dynamic message sent from the app.</p>',
});
```

The mutation accepts `to`, `subject`, `text`, and an optional `html` string.
It uses the same SMTP settings described above; if SMTP isnt configured it
simply logs the payload to the backend console, which is handy for development
or testing.

This lets you drive mail delivery to any address at runtime rather than being
restricted to the user account tied to a reset request.

---

## Getting Started

First, run the development server:

```bash
npm run dev
# or
pnpm dev
# or
yarn dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see
the result.

You can start editing the page by modifying `app/page.tsx`. The page
auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load
[Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs)
- [Learn Next.js](https://nextjs.org/learn)

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the
[Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app).
